# Spire AI Master

基于 Python 和 PySide6 的《杀戮尖塔》AI 辅助工具。通过实时分析游戏状态，为玩家提供出牌建议。

## 🚀 快速开始

### 1. 启动游戏
确保已安装并启用了 **CommunicationMod**。

### 2. 启动后端 (AI Engine)
```bash
python src/main.py
```
终端显示 `GameBridge initialized` 即表示后端已就绪，正在等待游戏连接。

### 3. 启动前端 (Overlay UI)
```bash
python src/ui/overlay_ui.py
```
UI 窗口将自动连接到后端，并置顶显示当前手牌的推荐评分。

## 📚 文档

详细文档请参阅 `docs/` 目录：
- [项目总结 (Project Summary)](docs/project_summary.md): 架构图、核心功能说明。
- [问题追踪 (Bug Tracker)](docs/bug_tracker.md): 常见问题及解决方案（编码、端口、死锁等）。
- [项目结构](docs/PROJECT_STRUCTURE.md): 文件目录说明。

## ✨ 核心特性

*   **实时推荐**: 基于启发式算法（参考 Bottled AI）实时计算卡牌评分。
*   **无缝融合**: 半透明、无边框置顶 UI，不干扰游戏体验。
*   **智能决策**:
    *   **AOE 识别**: 智能识别群体攻击时机。
    *   **力量成长**: 动态调整多段攻击优先级。
    *   **斩杀计算**: 优先推荐能终结敌人的卡牌。
*   **双模式**: 支持“辅助模式”（仅推荐）和“自动模式”（AI 接管）。

## 🔧 技术栈
*   **Backend**: Python, spirecomm (CommunicationMod 协议库)
*   **Frontend**: PySide6 (Qt for Python)
*   **IPC**: TCP Socket (JSON Protocol)



# 项目计划
# 项目在一些开源项目的基础上进行开发。有好几个方案，我准备采取快速迭代部署的方式。先从简单的开始，逐步完善。


## 方案一：规则引擎 + QT 辅助（最快落地，1-2周可见原型）
这是成本最低、效果最直观的方案。先不折腾复杂的模型训练，而是先搭建起“数据通路”。
### 技术栈： spirecomm + Bottled AI (逻辑参考) + C++Qt6(界面)
### 实现逻辑：
#### 1.使用 spirecomm 获取当前游戏状态（手牌、能量、怪物意图）。
#### 2.参考 Bottled AI 中的启发式算法（例如：每张牌有基础分，根据当前状态加减分）。
#### 3.QT 界面： 做一个透明置顶窗口，实时显示每张手牌的“得分”和“推荐操作”。
### 优点： 逻辑可控，调试极其方便，不需要高性能显卡跑训练。
### 缺点： 策略上限受限于你写的规则。

## 方案二：预训练模型 + QT 联动（平衡方案，3-4周）
我希望项目看起来更有“AI感”，可以直接借用社区已有的 RL 成果。
### 技术栈： spirecomm + slai-the-spire (模型部分) + C++Qt6(界面)
### 实现逻辑：
#### 1.利用 slai-the-spire 项目中已经定义好的 Observation Space（特征工程）。
#### 2.直接加载该项目提供的预训练权重（DQN 模型）。
#### 3.当 spirecomm 拿到状态后，将其向量化输入模型，得到 $Q$ 值（动作评价）。
#### 4.QT 界面展示 $Q$ 值最高的动作。
### 优点： 真正意义上的强化学习落地，能够处理复杂的卡牌连锁。
### 缺点： slai-the-spire 的模型特征维度复杂，代码适配需要一定功底。

## 方案三：自研轻量级 RL（学术/深造方案，1个月以上）
为了学习 RL 全过程，想做一个完全属于自己的 AI。
### 技术栈： spirecomm + Stable Baselines3 + Gymnasium
### 实现逻辑：
#### 1.封装环境： 使用 spirecomm 作为底层，按照 OpenAI Gym 标准封装一个 SpsEnv。
#### 2.简化状态： 初期只给 AI 输入简单的特征（如：血量、能量、攻击牌数量）。
#### 3.训练与部署： 训练完成后，导出 .zip 或 .onnx 模型文件，供 QT 界面调用。
### 优点： 整个链路完全自主可控，论文或项目演示价值极高。
### 缺点： 训练非常耗时，且容易出现 AI 怎么学也学不会（不收敛）的情况。
